/*
(c) 2011-2014, Vladimir Agafonkin
SunCalc is a JavaScript library for calculating sun/mooon position and light phases.
https://github.com/mourner/suncalc
*/

(function(){function v(a){return new Date((a+.5-n)*p)}function w(a,b){return h(c(a)*f(l)-m(b)*c(l),f(a))}function A(a,b){return x(c(b)*f(l)+f(b)*c(l)*c(a))}function q(a,b,d){return h(c(a),f(a)*c(b)-m(d)*f(b))}function D(a,b,d){return x(c(b)*c(d)+f(b)*f(d)*f(a))}function E(a){var b=e*(1.9148*c(a)+.02*c(2*a)+3E-4*c(3*a));return a+b+102.9372*e+r}function F(a){a=E(e*(357.5291+.98560028*a));return{dec:A(a,0),ra:w(a,0)}}function G(a){var b=e*(134.963+13.064993*a),d=e*(93.272+13.22935*a);a=e*(218.316+13.176396*
a)+6.289*e*c(b);d=5.128*e*c(d);b=385001-20905*f(b);return{ra:w(a,d),dec:A(a,d),dist:b}}var r=Math.PI,c=Math.sin,f=Math.cos,m=Math.tan,x=Math.asin,h=Math.atan2,H=Math.acos,e=r/180,p=864E5,n=2440588,l=23.4397*e,g={getPosition:function(a,b,d){d=e*-d;b*=e;var c=a.valueOf()/p-.5+n-2451545;a=F(c);d=e*(280.16+360.9856235*c)-d-a.ra;return{azimuth:q(d,b,a.dec),altitude:D(d,b,a.dec)}}},B=g.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],
[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];g.addTime=function(a,b,d){B.push([a,b,d])};g.getTimes=function(a,b,d){d=e*-d;b*=e;a=Math.round(a.valueOf()/p-.5+n-2451545-9E-4-d/(2*r));var k=9E-4+(0+d)/(2*r)+a,g=e*(357.5291+.98560028*k),h=E(g),l=A(h,0),k=2451545+k+.0053*c(g)-.0069*c(2*h),s,m,y,t,z,C={solarNoon:v(k),nadir:v(k-.5)};s=0;for(m=B.length;s<m;s+=1){y=B[s];t=d;z=a;var w=g,x=h,u;u=b;var q=l;u=H((c(y[0]*e)-c(u)*c(q))/(f(u)*f(q)));t=2451545+(9E-4+(u+t)/(2*r)+z)+.0053*c(w)-.0069*c(2*
x);z=k-(t-k);C[y[1]]=v(z);C[y[2]]=v(t)}return C};g.getMoonPosition=function(a,b,d){d=e*-d;b*=e;var c=a.valueOf()/p-.5+n-2451545;a=G(c);d=e*(280.16+360.9856235*c)-d-a.ra;c=D(d,b,a.dec);c+=.017*e/m(c+10.26*e/(c+5.1*e));return{azimuth:q(d,b,a.dec),altitude:c,distance:a.dist}};g.getMoonIllumination=function(a){var b=a.valueOf()/p-.5+n-2451545;a=F(b);var b=G(b),d=H(c(a.dec)*c(b.dec)+f(a.dec)*f(b.dec)*f(a.ra-b.ra)),d=h(149598E3*c(d),b.dist-149598E3*f(d));a=h(f(a.dec)*c(a.ra-b.ra),c(a.dec)*f(b.dec)-f(a.dec)*
c(b.dec)*f(a.ra-b.ra));return{fraction:(1+f(d))/2,phase:.5+.5*d*(0>a?-1:1)/Math.PI,angle:a}};"function"===typeof define&&define.amd?define(g):"undefined"!==typeof module?module.exports=g:window.SunCalc=g})();